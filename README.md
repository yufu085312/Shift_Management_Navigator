# シフト管理ナビ (Shift Management Navigator)

小規模店舗向けのシフト管理を簡素化し、管理者とスタッフ双方の負担を軽減するFlutterアプリケーションです。
最新のアップデートにより、スタッフ招待フローの簡略化と、データの整合性を保つための自動クリーンアップ機能が強化されました。

## 🚀 主要機能

### 管理者機能
- **店舗セットアップ**: 店舗名・IDの初期設定。
- **スタッフ招待フロー**: 店舗IDをスタッフに共有するだけで、簡単にスタッフ登録が可能。
- **シフト作成・公開**: 統合されたメニューから、カレンダー上でのシフト作成とスタッフへの公開が一気に完結。
- **データクリーンアップ**: スタッフ削除時に、そのスタッフの未来のシフトや未処理の申請を自動的に一括削除し、運営の整合性を維持。
- **ダッシュボード**: 店舗の稼働状況や未処理の申請を一目で確認。

### スタッフ機能
- **店舗参加**: 管理者から共有された店舗IDを入力するだけで、すぐに所属が可能。
- **マイシフト**: 自分の確定シフトをカレンダー形式でリアルタイムに確認。
- **スマート申請**: 希望の提出、シフト変更、代打申請をスムーズに管理者に相談。
- **通知一覧**: 管理者からの連絡や申請の承認結果を即座に受信。

---

## 🛠 環境構築

### 1. 前提条件
- **Flutter SDK**: `3.27.1` 以上
- **Dart SDK**: `3.6.0` 以上
- **Firebase CLI**: インストールおよびログイン済み
- **Xcode / Android Studio**

### 2. セットアップ
```bash
git clone <repository_url>
cd Shift_Management_Navigator
flutter pub get
```

### 3. Firebaseの設定
```bash
flutterfire configure
```
※ `lib/firebase_options.dart` が生成されます。Firestore、Authentication（メール/パスワード）を有効にしてください。

---

## 🏃 実行方法

### Web版 (推奨)
```bash
flutter run -d chrome --web-port=8080
```

### デスクトップ/モバイル版
```bash
flutter run
```

---

## ✅ 動作確認ステップ

1. **管理者登録と店舗作成**:
   - 「新規登録」から役割を **「管理者」** にしてアカウントを作成。
   - ログイン後、「店舗セットアップ」で店舗を作成し、発行された **「店舗ID」** を確認。

2. **スタッフの招待**:
   - 「スタッフ管理」画面で「店舗IDをコピー」し、スタッフ役に共有。
   - 別ウィンドウ等で、役割を **「スタッフ」** にして新規登録。
   - スタッフ画面で **「店舗ID」** を入力し、店舗に参加。

3. **シフトの作成と公開**:
   - 管理画面の「シフト作成・公開」からカレンダー上でシフトを登録。
   - 画面右上のアイコンから「公開」を実行。

4. **スタッフ画面での確認**:
   - スタッフの「マイシフト」に公開された内容が反映されていることを確認。

5. **スタッフ削除とクリーンアップ（検証）**:
   - 管理画面でスタッフを削除。対象者の未来のシフトや申請が自動で消去され、スタッフ側のアカウントが「店舗未所属」に戻ることを確認。

---

## 🏗 技術スタック
- **Framework**: Flutter (Material 3)
- **State Management**: Riverpod
- **Backend/DB**: Cloud Firestore (Atomic Batch updates & Memory filters)
- **Authentication**: Firebase Auth
- **UI Components**: `table_calendar`, `freezed`, `intl`
